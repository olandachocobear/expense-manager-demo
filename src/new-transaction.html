<link rel="import" href="../bower_components/polymer/polymer-element.html">
<link rel="import" href="../bower_components/vaadin-button/vaadin-button.html">
<link rel="import" href="../bower_components/vaadin-dialog/vaadin-dialog.html">

<link rel="import" href="../bower_components/number-input/number-input.html">
<link rel="import" href="../bower_components/iron-ajax/iron-ajax.html">
<link rel="import" href="constant.html">

<link rel="import" href="./vouchers-area.html">
<link rel="import" href="./styles-reskin.html">

<script src="./js/new-transaction.js"></script>

<dom-module id="new-transaction-layout">
  <template>
      <iron-ajax id="processRedeem" 
          url={{ironUrl}} method="post" 
          body="{{bodyRequest}}"
          headers='{"Content-Type": "application/json"}'
          on-response="eligibleResponse"
          on-error="onError"
          timeout=30000>
      </iron-ajax>
  
          <style include="responsive-layout">
              .wrapper {
                /* display: flex; */
                margin-top: var(--lumo-space-s);
              }
    
              #form {
                min-width: 300px;
                display: flex;
                flex-direction: column;
              }
    
              #upload {
                margin-left: var(--lumo-space-l);
              }
    
              .buttons vaadin-button {
                margin-right: var(--lumo-space-m);
              }
    
              vaadin-text-area {
                min-height: 125px;
              }
    
              img {
                max-width: 350px;
              }
    
              @media (max-width: 900px) {
                [part~="overlay"] {
                  align-self: stretch;
                  border-radius: 0;
                }
    
                #upload {
                  margin: 10px 0;
                }
    
                .wrapper {
                  flex-direction: column;
                }
    
                .receipt-wrapper img {
                  max-width: 100%;
                }
              }
              h4 {
                font-size: 10px;
                margin-bottom: -18px;
              }
              h2 {
                margin-bottom:13px;
              }
              #reset_btn { display: none}
              #reset_btn[shown] {display: block;}
              
              #remaining { display: none; }
              
              @media (max-width:500px){
                #remaining { margin-top:-62px }
              }
              @media (min-width:501px){
                #remaining { margin-top:-60px }
              }

              #remaining[shown] {display: block;}
              #remaining[disabled] {
                  color: #000 !important;
                  font-size: 20px !important;
                  font-style: oblique;
              }
          </style>

        

    <div class="wrapper">
      <big-voucher>
          <img src='images/voucher-hand.png'>
      </big-voucher>

      <div id=main>
        <h3 style=color:#4d4d4d;font-weight:normal;font-size:1.4em;margin-top:60px>VOUCHER REDEMPTION</h3>
        <h1 style=margin-top:-12px;color:#246eb6;font-size:2.2em>[[merchantName]]</h1>
        <h3 style="margin-top: -15px; font-size:1.1em;color:#808184;">
          [[storeName]]
        </h3>

        <div id="form">
            <!-- <iron-a11y-keys keys="enter" on-keys-pressed="_save"></iron-a11y-keys> -->
            
            <!-- <vaadin-combo-box name="merchant" items='[{"label": "Voucher", "value": 0}, {"label": "Coupon", "value": 1}]' value="{{_expense.transType}}" selected="Voucher" label="Type Promotion" required></vaadin-combo-box> -->

            <vaadin-text-field name="total" 
              prevent-invalid-input pattern="[0-9.]*" value="{{fieldAmount}}" 
              on-change="detectChanges" label="TOTAL TRANSACTION" 
              required apply-format
              style="--lumo-text-field-size: var(--lumo-size-l);
                    font-size: var(--lumo-font-size-xl);
                    margin-top:10px;
                    --lumo-font-size-s: 18px;
                    --lumo-secondary-text-color: #246eb6;">
              <div slot="prefix">Rp</div>
            </vaadin-text-field>


            <div class="vaadin-text-field-container" style="margin-top:26px;
                  font-weight:500; 
                  font-size: var(--lumo-font-size-s); 
                  color: var(--lumo-secondary-text-color);
            ">
                <label part="label" id="vaadin-text-field-label-11">Voucher code</label>
            </div>

            <div style="margin-top:7px;
                        width: 100%;
                        text-align: center;">

            <vouchers-area add-allowed=false> </vouchers-area>
            </div>  
            
            
            <!-- <vaadin-text-area name="comment" label="Comment" value="{{_expense.comment}}"></vaadin-text-area> -->
            
            
            <vaadin-text-field readonly id="remaining" theme="align-right" 
              value="Rp [[remainingTxt]]" label="Remaining Amount" pattern="[0-9]*"
              shown$="[[displayRemaining]]">
                <div slot="prefix"></div>
            </vaadin-text-field>


            <div style="display:none;margin-top:31px;
            margin-bottom:28px; text-align:center">
              
            </div>
          </div>
<!-- 
        <center style=margin-top:17px;margin-bottom:18px> ----- </center> -->


        <!-- disabled=[[!validTrx]]  -->
        <div class="buttons" style=text-align:center;margin-bottom:-10px;margin-top:8px>
          <vaadin-button theme$="[[redeemable]]" disabled=[[!validTrx]] on-click="_burn" style="opacity:0.84;height:50px;width:100%">Redeem!</vaadin-button>
          <vaadin-button id=reset_btn shown$="[[resetable]]" theme="tertiary" on-click="_reset"
            style="font-weight:normal;color:red;margin-left:15px"><u>Reset</u></vaadin-button>
        </div>
      </div>

    <copyright>
        2017 MAP
    </copyright>
   </div>
  </template>
  
</dom-module>

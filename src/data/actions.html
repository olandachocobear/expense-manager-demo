<script>
  (() => {
    const uuid = () => ([1e7] + -1e3 + -4e3 + -8e3 + -1e11).replace(/[018]/g, a => (a ^ Math.random() * 16 >> a / 4).toString(16));

    const login = () => {
      return {type: 'LOGIN'};
    };

    const logout = () => {
      return {type: 'LOGOUT'};
    };

    const editExpense = (expense = {}) => {
      return {
        type: 'EDIT_EXPENSE',
        expense
      };
    };

    const deleteExpense = (expense) => {
      return {
        type: 'DELETE_EXPENSE',
        expense
      };
    };

    const saveExpense = (expense) => {
      if (expense.id) {
        return {
          type: 'UPDATE_EXPENSE',
          expense
        };
      } else {
        return {
          type: 'ADD_EXPENSE',
          expense: Object.assign({}, expense, {
            id: uuid(),
            status: 'new'
          })
        };
      }
    };

    const cancelEdit = () => {
      return {type: 'CANCEL_EDIT'};
    };

    const clearFilters = () => {
      return {type: 'CLEAR_FILTERS'};
    };

    const toggleFilters = () => {
      return {type: 'TOGGLE_FILTERS'};
    };

    const hideFilters = () => {
      return {type: 'HIDE_FILTERS'};
    };

    const filtersUpdated = filters => {
      return {
        type: 'FILTERS_UPDATED',
        filters
      };
    };

    const showInfoDialog = () => {
      return {type: 'SHOW_INFO_DIALOG'};
    };

    const hideInfoDialog = () => {
      return {type: 'HIDE_INFO_DIALOG'};
    };

    const addVoucher = last_id => {
      let new_voucher = {
        'id': (last_id+1),
        'uniqueCode': '',
        'voucherType': ' Go-deals 25k  ',
        'voucherDetail': '',
        'voucherAmount': '',
        'voucherEligible': false,
        'onCheck': false,
        'errorCode': '',
        'errorMsg': ''
      }
      return {type: 'ADD_VOUCHER', new_voucher};
    }

    const updateVoucher = voucher => {
      return {type: 'UPDATE_VOUCHER', voucher};
    }
    const updateTransactionAmount = amount => {
      return {type: 'UPDATE_TX_AMOUNT', amount};
    }
    const updateTransactionable = valids => {
      return {type: 'UPDATE_TXABLE', valids};
    }
    const resetForm = () => {
      return {type: 'RESET_ALL'};
    }

    const removeVoucher = (id) => {
      return {type: 'REMOVE_VOUCHER', id};
    }
    
    const updateRemaining = (amt) => {
      return {type: 'UPDATE_REMAINING', amt};
    }
    
    const logMeIn = (user) => {
      return {type: 'LOGGING_IN', user}
    }

    const updateErrorCode = (code) => {
      return {type: 'UPDATE_ERROR_CODE', code}
    }
    const updateErrorMsg = (msg) => {
      return {type: 'UPDATE_ERROR_MSG', msg}
    }
    
    const showReceipt = () => {
      return {type: 'SHOW_RECEIPT'}
    }

    const hideReceipt = () => {
      return {type: 'HIDE_RECEIPT'}
    }
    
    const showREreceipt = () => {
      return {type: 'SHOW_RERECEIPT'}
    }

    const hideREreceipt = () => {
      return {type: 'HIDE_RERECEIPT'}
    }

    const addLastTransaction = (trx) => {
      return {type: 'APPEND_TX', trx}
    }
    
    const changeMenu  = (page) => {
      return {type: 'SWITCH_PAGE', page}
    }

    const nextPage = () => {
      return {type: 'PAGE_INCREASE'}
    }
    
    const testRemove = () => {
      return {type: 'TEST_REMOVE'}
    }
    
    const appendBurned = (lists) => {
      return {type: 'APPEND_BURNED_LIST', lists}
    }
    const insertBurned = (lists) => {
      return {type: 'FRESH_BURNED_LIST', lists}
    }

    const searchVoucher = (voucher) => {
      return {type: 'SEARCH_VOUCHER', voucher}
    }
    
    const resetTrx = () => {
      return {type: 'RESET_TX'}
    }
    const showAlert = () => {
      return {type: 'SHOW_SMILEY_DIALOG'}
    }
    const changeTitleAlert = (title) => {
      return {type: 'MODIFY_TITLE', title}
    }
    const changeHeaderAlert = (header) => {
      return {type: 'MODIFY_HEADER', header}
    }
    const changeMessageAlert = (msg) => {
      return {type: 'MODIFY_MSG', msg}
    }
    const changeAlertButton = (button) => {
      return {type: 'MODIFY_BUTTON', button}
    }
    const changeAlertIcon = (icon) => {
      return {type: 'CHANGE_SMILEY', icon}
    }
    const hideAlert = () => {
      return {type: 'HIDE_SMILEY_DIALOG'}
    }
    const increaseConnAttempt = () => {
      return {type: 'ADD_CONN_ATTEMPT'}
    }
    const resetConnAttempt = () => {
      return {type: 'RESET_CONN_ATTEMPT'}
    }
    const updateFilter = () => {
      return {type: 'UPDATE_REQUEST'}
    }
    const updateDone = () => {
      return {type: 'UPDATE_DONE'}
    }
    const generateReceipt = (traceNo) => {
      return {type: 'GENERATE_RECEIPT', traceNo}
    }
    const togglePwdDialog = (cond) => {
      return {type: 'TOGGLE_PWD_DIALOG', cond}
    }

    window.ExpenseManager = window.ExpenseManager || {};
    window.ExpenseManager.actions = {
      login,
      logout,
      editExpense,
      deleteExpense,
      saveExpense,
      cancelEdit,
      clearFilters,
      toggleFilters,
      hideFilters,
      filtersUpdated,
      showInfoDialog,
      hideInfoDialog,

      addVoucher,
      removeVoucher,
      updateVoucher,
      updateTransactionable,
      resetForm,
      updateTransactionAmount,
      updateRemaining,

      logMeIn,
      updateErrorCode,
      updateErrorMsg,

      showReceipt,
      hideReceipt,
      showREreceipt,
      hideREreceipt,
      generateReceipt,

      addLastTransaction,
      
      changeMenu,
      nextPage,
      
      testRemove,

      appendBurned,
      insertBurned,

      searchVoucher,
      resetTrx,

      showAlert,
      hideAlert,
      changeMessageAlert,
      changeTitleAlert,
      changeHeaderAlert,
      changeAlertButton,
      changeAlertIcon,

      increaseConnAttempt,
      resetConnAttempt,

      updateFilter,
      updateDone,

      togglePwdDialog
    };
  })();
</script>
